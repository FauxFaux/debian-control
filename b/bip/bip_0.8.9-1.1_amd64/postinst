#!/bin/sh

set -e

BIPUSER=bip
BIPGROUP=bip
BIPHOME=/var/lib/bip

chgrp "$BIPGROUP" "$BIPHOME" 2>/dev/null || addgroup --system "$BIPGROUP"
chown "$BIPUSER"."$BIPGROUP" "$BIPHOME" 2>/dev/null || \
	adduser --system --home "$BIPHOME" --disabled-password \
	--ingroup "$BIPGROUP" "$BIPUSER"

if [ ! -e /var/log/bip ]
then
	mkdir /var/log/bip
	chown "$BIPUSER":"$BIPGROUP" /var/log/bip
	chmod 750 /var/log/bip
fi

if [ "$1" = "configure" -a "$2" = "" ]
then
	chown root:"$BIPGROUP" /etc/bip.conf
	chmod 640 /etc/bip.conf
fi

# Automatically added by dh_installinit
if [ "$1" = "configure" ] || [ "$1" = "abort-upgrade" ]; then
	if [ -x "/etc/init.d/bip" ]; then
		update-rc.d bip defaults >/dev/null
		invoke-rc.d bip start || exit $?
	fi
fi
# End automatically added section

