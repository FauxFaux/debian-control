#!/bin/sh
# vim: ts=4:et:sts=4
# $Id: dictd.postrm 89 2009-01-03 16:34:01Z robert $

set -e

PACKAGE=dictd
DEFAULTSFILE=/etc/default/$PACKAGE


cleanupUcf() 
{
    # we mimic dpkg as closely as possible, so we remove configuration
    # files with dpkg backup extensions too:
    for ext in '~' '%' .bak .ucf-new .ucf-old .ucf-dist .dpkg-tmp '';  do
        rm -f "${DEFAULTSFILE}${ext}"
    done
    ! which ucf  >/dev/null || ucf  --purge "$DEFAULTSFILE"
    ! which ucfr >/dev/null || ucfr --purge "$PACKAGE" "$DEFAULTSFILE"
}

# Automatically added by dh_installinit/11.3.5
if [ "$1" = "purge" ] ; then
	update-rc.d dictd remove >/dev/null
fi


# In case this system is running systemd, we make systemd reload the unit files
# to pick up changes.
if [ -d /run/systemd/system ] ; then
	systemctl --system daemon-reload >/dev/null || true
fi
# End automatically added section
# Automatically added by dh_installdebconf/11.3.5
if [ "$1" = purge ] && [ -e /usr/share/debconf/confmodule ]; then
	. /usr/share/debconf/confmodule
	db_purge
fi
# End automatically added section
 

case "$1" in
   failed-install|abort-install|abort-upgrade|failed-upgrade)
        exit 0
    ;;

    remove)
        rm -fr /var/lib/dictd/
        exit 0
    ;;
    purge)

        rm -f /var/lib/dictd/db.list
        rm -rf /var/lib/dictd/ 
        [ ! -d /etc/dictd ] || rmdir  --ignore-fail-on-non-empty /etc/dictd || true
        cleanupUcf

        # remove inetd entry
        ! which update-inetd >/dev/null || update-inetd --remove "dict" >/dev/null 2>&1 || true

        # remove user, group and home directory dictd
        deluser --remove-home dictd >/dev/null 2>&1 || true

        exit 0
    ;;
    upgrade|disappear)
        exit 0
    ;;
    *)
        echo "postrm called with unknown argument \`$1'" >&2
        exit 0
    ;;
esac
