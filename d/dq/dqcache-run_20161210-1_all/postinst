#!/bin/sh -e
set -e

if [ x"$1" != "xconfigure" ]; then
  exit 0
fi

if ! getent passwd dqcachelog > /dev/null; then
  adduser --quiet --system --no-create-home --disabled-password --home /nonexistent --ingroup nogroup --gecos "dqcachelog user" dqcachelog
fi

if ! getent passwd dqcache > /dev/null; then
  adduser --quiet --system --no-create-home --disabled-password --home /nonexistent --ingroup nogroup --gecos "dqcache user" dqcache
fi

chown -R dqcache /var/lib/dqcache/root/dump
chown -R dqcachelog /var/log/dqcache

if [ -e /etc/service/dqcache ]; then
  echo "/etc/service/dqcache exist."
else
  echo -n "linking: /var/lib/dqcache/service/dqcache -> /etc/service/dqcache"
  ln -s /var/lib/dqcache/service/dqcache /etc/service/dqcache
  echo ". done."
fi


