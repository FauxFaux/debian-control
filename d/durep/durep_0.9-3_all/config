#!/bin/sh

set -e

CONFFILE=/etc/default/durep-rolling
. /usr/share/debconf/confmodule

[ ! -f $CONFFILE ] || . $CONFFILE

if test -n "$HTTPFILEROOT" -a -d "$HTTPFILEROOT" ; then
   db_set durep/httpfileroot "$HTTPFILEROOT"
fi

db_input high durep/httpfileroot || true
db_go || true

db_input low durep/makereports || touch $CONFFILE.no-debconf-changes
db_go

if test -r $CONFFILE && ! test -e $CONFFILE.no-debconf-changes ; then
   # oh, user is doing interactive setup and wants to see the latest list. Maybe.
   . $CONFFILE
   if test -n "$FILESYSTEMS" ; then
      db_set durep/filesystems "$FILESYSTEMS"
   fi
fi
   

db_get durep/makereports || true
if [ "$RET" = true ] ; then
   db_input high durep/filesystems || true
   db_go
fi

