#!/bin/sh

set -e

if perl -MFile::DesktopEntry -MPath::Tiny -MFile::Which -MSet::Scalar -E 1 2>/dev/null; then
    /usr/share/flwm/generate-flwm-menu-from-desktop-files
fi

case "$1" in
triggered)
    exit 0
    ;;

*)
    # Remove (autogenerated) legacy menu files
    if [ -d /etc/X11/flwm/wmx ]; then
	rm -r /etc/X11/flwm/wmx
    fi

    inst=/etc/menu-methods/flwm

    if [ -f $inst ]; then
	chmod a+x $inst
    fi
    ;;
esac

# Automatically added by dh_installmenu/11
if [ "$1" = "configure" ] && [ -x "`which update-menus 2>/dev/null`" ]; then
	update-menus
fi
# End automatically added section
# Automatically added by dh_installwm/11
if [ "$1" = "configure" ]; then
	update-alternatives --install /usr/bin/x-window-manager \
		x-window-manager /usr/bin/flwm 20 \
		--slave /usr/share/man/man1/x-window-manager.1.gz \
		x-window-manager.1.gz /usr/share/man/man1/flwm.1.gz
fi
# End automatically added section


exit 0
