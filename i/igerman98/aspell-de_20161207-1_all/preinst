#! /bin/sh
# preinst script for aspell-de

set -e

# summary of how this script can be called:
#        * <new-preinst> `install'
#        * <new-preinst> `install' <old-version>
#        * <new-preinst> `upgrade' <old-version>
#        * <old-preinst> `abort-upgrade' <new-version>

case "$1" in
    install|upgrade)
	# Sarge shipped with the files in /usr/lib/aspell-0.60
	if dpkg --compare-versions "$2" lt-nl 0.60-20030222-1-4 ; then
	    # if the user changed the link, remember the status
	    unset LANG LC_MESSAGES LC_ALL
	    if update-alternatives --display de.multi | grep -q 'status is manual' &&
		update-alternatives --display de.multi | grep -q 'points to.*-neu' ; then
		    echo "Preserving old alternative de.multi -> aspell-de"
		    echo neu > /var/lib/aspell/de.multi.alternative-neu
	    fi

	    # remove the old links
	    update-alternatives --remove de.multi /usr/lib/aspell-0.60/de-neu.multi || :
	fi
    ;;

    abort-upgrade)
    ;;

    *)
	echo "preinst called with unknown argument \`$1'" >&2
	exit 1
    ;;
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

# Automatically added by installdeb-aspell
dico_class="aspell"
dico_compat="de.compat"

[ -d "/var/lib/$dico_class" ] || mkdir -p "/var/lib/$dico_class"

for i in $dico_compat; do
    >"/var/lib/$dico_class/$i"
done
# End automatically added section


exit 0

# vim:sw=4:
