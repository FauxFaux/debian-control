#!/bin/sh
# Copyright (C) 2018 Alkis Georgopoulos <alkisg@gmail.com>
# SPDX-License-Identifier: GPL-3.0-or-later
#
# Call update-kernels upon ltsp-client-core installation.

set -e

# https://www.debian.org/doc/debian-policy/#summary-of-ways-maintainer-scripts-are-called
# The postinst script may be called in the following ways:
# <postinst> configure <most-recently-configured-version>
# <old-postinst> abort-upgrade <new version>
# <conflictor's-postinst> abort-remove in-favour <package> <new-version>
# <postinst> abort-remove
# <deconfigured's-postinst> abort-deconfigure in-favour
#     <failed-install-package> <version>
#     [removing <conflicting-package> <version>]
#
# But it also can be called like this, from dpkg-reconfigure <package>:
# <postinst> reconfigure <most-recently-configured-version>

case "$1" in
    configure)
        /usr/share/ltsp/update-kernels
        ;;

    abort-upgrade|abort-remove|abort-deconfigure)
    ;;

    *)
        echo "postinst called with unknown argument \`$1'" >&2
        exit 1
        ;;
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

# Automatically added by dh_installdeb/12
dpkg-maintscript-helper rm_conffile /etc/init.d/ltsp-client-setup 5.5.4-3\~ -- "$@"
dpkg-maintscript-helper rm_conffile /etc/default/ltsp-client-setup 5.5.4-3\~ -- "$@"
# End automatically added section
# Automatically added by dh_installinit/12
if [ "$1" = "configure" ] || [ "$1" = "abort-upgrade" ] || [ "$1" = "abort-deconfigure" ] || [ "$1" = "abort-remove" ] ; then
	if [ -x "/etc/init.d/ltsp-client-core" ]; then
		update-rc.d ltsp-client-core defaults >/dev/null || exit 1
	fi
fi
# End automatically added section


exit 0
