#!/bin/sh

set -e

if [ "$1" = install ] || [ "$1" = upgrade ]
then
    # bad divert removal can be deleted in 2017 (after jessie and Ubuntu 16.04 releases)
    # see #712895
    BAD=$( dpkg-divert --list /usr/share/man/man1/json_pp.1.bundled.gz | wc -l )
    if [ "$BAD" = 1 ]
    then
        dpkg-divert --remove --package libjson-pp-perl --rename \
            --divert /usr/share/man/man1/json_pp.1.bundled.gz /usr/share/man/man1/json_pp.1.gz
    fi
    # end bad divert removal

    dpkg-divert --add --package libjson-pp-perl --rename \
        --divert /usr/bin/json_pp.bundled /usr/bin/json_pp

    # this diversion is needed even if we don't actually ship json_pp.1.gz,
    # because otherwise it takes precedence over json_pp.1p.gz (which we do
    # ship)
    dpkg-divert --add --package libjson-pp-perl --rename \
        --divert /usr/share/man/man1/json_pp.bundled.1.gz /usr/share/man/man1/json_pp.1.gz
fi

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.



exit 0
