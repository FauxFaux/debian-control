#!/bin/sh

set -e

if test -f /usr/share/debconf/confmodule; then
	. /usr/share/debconf/confmodule
fi

# Do dbconfig-common removal stuff
if test -f /usr/share/dbconfig-common/dpkg/postrm; then
	. /usr/share/dbconfig-common/dpkg/postrm
	dbc_go movim "$@"
fi

# custom actions
case $1 in
remove)
	;;

purge)
	# unregister
	rm -f /var/lib/movim/dbconfig.inc
	if which ucf >/dev/null 2>&1; then
		ucf --purge /var/lib/movim/dbconfig.inc
		ucfr --purge movim /var/lib/movim/dbconfig.inc
	fi
	# remove state/dynamic data
	rm -rf /var/lib/movim /var/log/movim /var/cache/movim
	;;

upgrade|disappear|failed-upgrade|abort-install|abort-upgrade)
	;;

*)
	echo >&2 "postrm called with unknown subcommand '$1'"
	exit 1
	;;
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

# Automatically added by dh_installsystemd/11.5.4
if [ -d /run/systemd/system ]; then
	systemctl --system daemon-reload >/dev/null || true
fi
# End automatically added section
# Automatically added by dh_installsystemd/11.5.4
if [ "$1" = "remove" ]; then
	if [ -x "/usr/bin/deb-systemd-helper" ]; then
		deb-systemd-helper mask 'movim.service' >/dev/null || true
	fi
fi

if [ "$1" = "purge" ]; then
	if [ -x "/usr/bin/deb-systemd-helper" ]; then
		deb-systemd-helper purge 'movim.service' >/dev/null || true
		deb-systemd-helper unmask 'movim.service' >/dev/null || true
	fi
fi
# End automatically added section
# Automatically added by dh_installdebconf/11.5.4
if [ "$1" = purge ] && [ -e /usr/share/debconf/confmodule ]; then
	. /usr/share/debconf/confmodule
	db_purge
fi
# End automatically added section


exit 0
