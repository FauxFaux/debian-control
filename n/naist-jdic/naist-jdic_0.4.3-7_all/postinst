#!/bin/sh
# postinst script for naist-jdic
#
# see: dh_installdeb(1)

set -e

priority="70"

chasendir="/usr/share/chasen"
chasenrc="${chasendir}/chasenrc"
dictdir="${chasendir}/dic/naist-jdic"

srcdir=${dictdir}
destdir="/var/lib/chasen/dic/naist-jdic"
GENDATA="matrix.cha table.cha chadic.da chadic.lex chadic.dat"

case "$1" in
    configure)
    echo "Now generating naist-jdic data. This may take a while..."

#   for matrix.cha table.cha
    [ -d ${srcdir} ] && [ -d ${destdir} ] || exit 1
    cd ${srcdir} && `chasen-config --mkchadic`/makemat -i e

#   for chadic.da chadic.lex chadic.dat
    [ -d "${srcdir}" ] && [ -d "${destdir}" ] || exit 1
    cd ${srcdir} && `chasen-config --mkchadic`/makeda -i e chadic *.dic 

    for i in `ls ${srcdir}/*`; do ln -s $i ${destdir}; done

    echo ""
    echo ""
    echo "Done! Check ${destdir} directory."


    update-alternatives \
     --install /etc/chasenrc chasenrc ${chasenrc} ${priority} \
     --slave /var/lib/chasen/dic/debian chasen-dictionary ${destdir} 

    ;;

    abort-upgrade|abort-remove|abort-deconfigure)
    ;;

    *)
        echo "postinst called with unknown argument \`$1'" >&2
        exit 1
    ;;
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.



exit 0
