#!/bin/sh

set -e

# These are included manually, as the postinst needs custom ordering.
dpkg-maintscript-helper mv_conffile /etc/default/ntp /etc/default/ntpsec 1.1.0\+dfsg1-2\~ ntpsec -- "$@"
dpkg-maintscript-helper mv_conffile /etc/init.d/ntp /etc/init.d/ntpsec 1.1.0\+dfsg1-2\~ ntpsec -- "$@"
dpkg-maintscript-helper mv_conffile /etc/ntp.conf /etc/ntpsec/ntp.conf 1.1.0\+dfsg1-2\~ ntpsec -- "$@"

installinit_error() {
	status=$?
	start-stop-daemon --stop --quiet --oknodo --pidfile /run/ntpd.pid && exit 0
	exit $status
}

# Automatically added by dh_installinit/11.5.4
if [ -x "/etc/init.d/ntpsec" ] && [ "$1" = remove ]; then
	invoke-rc.d ntpsec stop || installinit_error
fi
# End automatically added section
# Automatically added by dh_installdeb/11.5.4
dpkg-maintscript-helper mv_conffile /etc/dhcp/dhclient-exit-hooks.d/ntp /etc/dhcp/dhclient-exit-hooks.d/ntpsec 1.1.0\+dfsg1-2\~ ntpsec -- "$@"
dpkg-maintscript-helper mv_conffile /etc/NetworkManager/dispatcher.d/ntp /etc/NetworkManager/dispatcher.d/ntpsec 1.1.0\+dfsg1-2\~ ntpsec -- "$@"
# End automatically added section
# Automatically added by dh_systemd_start/11.5.4
if [ -d /run/systemd/system ] && [ "$1" = remove ]; then
	deb-systemd-invoke stop 'ntpsec-rotate-stats.timer' 'ntpsec-systemd-netif.path' >/dev/null || true
fi
# End automatically added section

