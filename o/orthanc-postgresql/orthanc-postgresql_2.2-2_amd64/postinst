#!/bin/sh

set -e

case $1 in
    configure)
        # Configure the permissions of the configuration file
        chown orthanc:orthanc /etc/orthanc/postgresql.json
        chmod 0664 /etc/orthanc/postgresql.json

	# Restart the Orthanc service
	# https://www.debian.org/doc/debian-policy/ch-opersys.html#s9.3.3.2
	if [ -x /etc/init.d/orthanc ]; then
	    if which invoke-rc.d >/dev/null 2>&1; then
     		invoke-rc.d orthanc restart
     	    else
     		/etc/init.d/orthanc restart
     	    fi
     	fi
	;;

    abort-upgrade|abort-remove|abort-deconfigure)
	;;

    *)
        echo "prerm called with unknown argument \`$1'" >&2
        exit 1
        ;;
esac


