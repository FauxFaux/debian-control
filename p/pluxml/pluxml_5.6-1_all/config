#! /bin/sh
set -e

. /usr/share/debconf/confmodule
db_version 2.0
db_capb backup

state=1
while true
do
    case $state
    in
        1) db_input medium pluxml/system/purgedata || true ;;
        2) db_input medium pluxml/system/writeconf || true ;;
        3) db_input medium pluxml/system/webservers || true ;;
        4) db_input medium pluxml/system/reload-webserver || true ;;
        5) db_input medium pluxml/blog/lang || true ;;
        6) db_input medium pluxml/blog/title || true ;;
        7) db_input medium pluxml/blog/description || true ;;
        8) db_input medium pluxml/blog/name || true ;;
        9) db_input medium pluxml/blog/login || true ;;
        10) db_input high pluxml/blog/password || true ;;
        11) db_input high pluxml/blog/confirm || true ;;
        12)
            db_get pluxml/blog/password
            password="$RET"
            db_get pluxml/blog/confirm
            confirm="$RET"
            if [ "$password" != "$confirm" ]
            then
                db_input high pluxml/blog/failpass
                state=10
                continue
            fi
        ;;
        *)
            # $state is greater than the last question (or lower than the first
            # one: see below): finished!  This will exit the while loop.
            break
        ;;
    esac

    if db_go
    then
        state=$((state + 1))
    else
        state=$((state - 1))
    fi
done

if [ $state -eq 0 ]
then
    # At the first question, the user asked to come back. This is a case that
    # cannot be handled, so it will break the installation, leaving packages
    # unconfigured.
    exit 10
fi

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.



exit 0
