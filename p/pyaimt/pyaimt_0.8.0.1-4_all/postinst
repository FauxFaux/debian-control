#!/bin/sh

set -e

case "$1" in
configure)
	if ! getent passwd pyaimt >/dev/null; then
		adduser --system --disabled-login \
			--no-create-home --home /var/lib/pyaimt \
			--group \
			pyaimt
	fi
	if test -n "$2" && dpkg --compare-versions "$2" le 0.11.1-4; then
		if test -f /var/log/jabber/pyaimt.log*; then
			mv /var/log/jabber/pyaimt.log* /var/log/pyaimt
		fi
	fi
	if ! dpkg-statoverride --list /var/log/pyaimt >/dev/null; then
		chown -R pyaimt:adm       /var/log/pyaimt
	fi
	if ! dpkg-statoverride --list /var/lib/pyaimt >/dev/null; then
		chown -R pyaimt:adm       /var/lib/pyaimt
	fi
	;;
abort-upgrade|abort-remove|abort-deconfigure)
	;;
*)
	echo "postinst called with unknown argument \`$1'" >&2
	exit 1
	;;
esac


# Automatically added by dh_python2:
if which pycompile >/dev/null 2>&1; then
	pycompile -p pyaimt /usr/share/pyaimt
fi

# End automatically added section
# Automatically added by dh_installinit
if [ -x "/etc/init.d/pyaimt" ]; then
	update-rc.d pyaimt defaults >/dev/null
	invoke-rc.d pyaimt start || exit $?
fi
# End automatically added section


exit 0
