#!/bin/sh

set -e

case "$1" in
configure)
	if ! getent passwd pyicqt >/dev/null; then
		adduser --system --disabled-login \
			--no-create-home --home /var/lib/pyicqt \
			--group \
			pyicqt
	fi
	if test -n "$2" && dpkg --compare-versions "$2" le 0.11.1-4; then
		if test -f /var/log/jabber/pyicqt.log*; then
			mv /var/log/jabber/pyicqt.log* /var/log/pyicqt
		fi
	fi
	if ! dpkg-statoverride --list /var/log/pyicqt >/dev/null; then
		chown -R pyicqt:adm       /var/log/pyicqt
	fi
	if ! dpkg-statoverride --list /var/lib/pyicqt >/dev/null; then
		chown -R pyicqt:adm       /var/lib/pyicqt
	fi
	;;
abort-upgrade|abort-remove|abort-deconfigure)
	;;
*)
	echo "postinst called with unknown argument \`$1'" >&2
	exit 1
	;;
esac


# Automatically added by dh_python2:
if which pycompile >/dev/null 2>&1; then
	pycompile -p pyicqt /usr/share/pyicqt
fi

# End automatically added section
# Automatically added by dh_installinit
if [ -x "/etc/init.d/pyicqt" ]; then
	update-rc.d pyicqt defaults >/dev/null
	invoke-rc.d pyicqt start || exit $?
fi
# End automatically added section


exit 0
