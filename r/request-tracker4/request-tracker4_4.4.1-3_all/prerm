#! /bin/sh

set -e

alts() {
    for bin in /usr/bin/rt-crontool /usr/sbin/rt-setup-database \
               /usr/sbin/rt-dump-metadata \
               /usr/sbin/rt-email-digest /usr/sbin/rt-email-dashboards \
               /usr/sbin/rt-clean-sessions /usr/sbin/rt-shredder \
               /usr/sbin/rt-email-group-admin /usr/sbin/rt-attributes-viewer \
               /usr/sbin/rt-fulltext-indexer /usr/sbin/rt-setup-fulltext-index \
               /usr/sbin/rt-validator /usr/sbin/rt-session-viewer \
               /usr/sbin/rt-preferences-viewer /usr/sbin/rt-validate-aliases \
               /usr/sbin/rt-importer /usr/sbin/rt-serializer \
               /usr/sbin/rt-externalize-attachments \
               /usr/sbin/rt-ldapimport; do
        alt=`basename $bin`
        update-alternatives --remove $alt $bin-4
    done
}

. /usr/share/debconf/confmodule
. /usr/share/dbconfig-common/dpkg/prerm 
dbc_go request-tracker4 $@

case "$1" in
    "remove") alts
        ;;
esac

# Automatically added by dh_installdeb
dpkg-maintscript-helper mv_conffile /etc/request-tracker4/RT_SiteConfig.d/60-logging /etc/request-tracker4/RT_SiteConfig.d/60-logging.pm -- "$@"
# End automatically added section
# Automatically added by dh_installdeb
dpkg-maintscript-helper mv_conffile /etc/request-tracker4/RT_SiteConfig.d/40-timezone /etc/request-tracker4/RT_SiteConfig.d/40-timezone.pm -- "$@"
# End automatically added section
# Automatically added by dh_installinit
if [ -x "/etc/init.d/request-tracker4" ]; then
	invoke-rc.d request-tracker4 stop || exit $?
fi
# End automatically added section
# Automatically added by dh_usrlocal
(
	while read dir; do
		rmdir "$dir" 2>/dev/null || true
	done
) << DATA
/usr/local/share/request-tracker4/static
/usr/local/share/request-tracker4/po
/usr/local/share/request-tracker4/plugins
/usr/local/share/request-tracker4/lib
/usr/local/share/request-tracker4/html
/usr/local/share/request-tracker4
DATA
# End automatically added section

