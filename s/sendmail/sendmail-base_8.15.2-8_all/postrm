#!/bin/sh
set -e;

PACKAGE=sendmail-base;

if [ "$1" = "remove" ]; then
		if [ -x /usr/sbin/update-inetd ]; then
            update-inetd --remove "^smtp";
            update-inetd --remove "^smtps";
            update-inetd --remove "^submission";
            fi;
fi

if [ "$1" = "purge" ]; then
		# Currently, dh_installdebconf doesn't do db_stop... ensure it is done!
		if [ "$1" = "purge" ] && [ -e /usr/share/debconf/confmodule ]; then
			# Source debconf library.
			. /usr/share/debconf/confmodule;
			# Make sure we're done
			#db_stop;
			# Remove my changes to the db.
			db_purge;
			fi;

		# Remove user/group smmsp
		if [ -x /usr/sbin/deluser ]; then
			deluser --quiet smmta || true;
			deluser --quiet smmsp || true;
			fi;
		userdel  smmta 2>/dev/null || true;
		groupdel smmta 2>/dev/null || true;
		userdel  smmsp 2>/dev/null || true;
		groupdel smmsp 2>/dev/null || true;

		# Purge those files installed in other package directories
        rm -f   /usr/lib/sasl/Sendmail.conf
        rm -f   /etc/certs/sendmail.pem;
        # Can't touch these as they may be included in slapd.conf
        #rm -rf /etc/ldap/schema/sendmail.schema;
        #rm -rf /etc/openldap/sendmail.schema;
        #rm -rf /etc/umich-ldap/sendmail.schema;
        # Purge psuedo conffiles (managed by sendmail)
        rm -f   /etc/mail/sendmail.conf;
        # Purge sendmail configuration files
        rm -f   /etc/mail/sendmail.mc \
            /etc/mail/submit.mc \
            /etc/mail/m4/dialup.m4 \
            /etc/mail/m4/provider.m4 \
            /etc/mail/local-host-names \
            /etc/mail/relay-domains \
            /etc/mail/trusted-users \
            /etc/mail/default-auth-info \
            /etc/mail/access \
            ;
fi

# Automatically added by dh_installdeb
dpkg-maintscript-helper rm_conffile /etc/dhcp3/dhclient-exit-hooks.d/sendmail 8.14.4-2.2\~ -- "$@"
# End automatically added section

