#! /bin/sh
# postrm script for sn
#
# see: dh_installdeb(1)

set -e

SNROOT=/var/spool/sn

# summary of how this script can be called:
#        * <postrm> `remove'
#        * <postrm> `purge'
#        * <old-postrm> `upgrade' <new-version>
#        * <new-postrm> `failed-upgrade' <old-version>
#        * <new-postrm> `abort-install'
#        * <new-postrm> `abort-install' <old-version>
#        * <new-postrm> `abort-upgrade' <old-version>
#        * <disappearer's-postrm> `disappear' <r>overwrit>r> <new-version>
# for details, see /usr/doc/packaging-manual/

case "$1" in
       purge|remove|upgrade|failed-upgrade|abort-install|abort-upgrade|disappear)
       if which update-inetd >/dev/null 2>&1 ; then
           update-inetd NEWS --remove 'nntp stream tcp nowait news.news /usr/sbin/tcpd /usr/sbin/snntpd logger -p news.info'
       fi
esac

case "$1" in
    purge)
	if [ -e /usr/share/debconf/confmodule ]; then
		. /usr/share/debconf/confmodule
		db_purge || true
	fi

	if grep -q '#-- sn begin' /etc/hosts.deny 2>/dev/null; then
		cp /etc/hosts.deny /etc/hosts.deny.new
		sed -e '/#-- sn begin/,/#-- sn end/d' \
			</etc/hosts.deny.new >/etc/hosts.deny
		rm -f /etc/hosts.deny.new
	fi
	if grep -q '#-- sn begin' /etc/hosts.allow 2>/dev/null; then	
		cp /etc/hosts.allow /etc/hosts.allow.new
		sed -e '/#-- sn begin/,/#-- sn end/d' \
			</etc/hosts.allow.new >/etc/hosts.allow
		rm -f /etc/hosts.allow.new
	fi
	rm -f /var/spool/sn/.fifo
        rm -rf /var/spool/sn
        rm /etc/news/sn/debian-config
       ;;

esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

# Automatically added by dh_installdebconf/11.5
if [ "$1" = purge ] && [ -e /usr/share/debconf/confmodule ]; then
	. /usr/share/debconf/confmodule
	db_purge
fi
# End automatically added section



