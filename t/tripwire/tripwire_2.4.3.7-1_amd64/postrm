#!/bin/sh

set -e

# Post-removal script for the Debian Tripwire distribution.

# Automatically added by dh_installdebconf/11.2.1
if [ "$1" = purge ] && [ -e /usr/share/debconf/confmodule ]; then
	. /usr/share/debconf/confmodule
	db_purge
fi
# End automatically added section



# Make sure we should be running...
case "$1" in
purge)
    host=$(uname -n)
    etc=/etc/tripwire
    var=/var/lib/tripwire
    report=$var/report
    rm -f $etc/tw.fifo \
	$etc/tw.config-1.2 \
	$etc/tw.cfg \
	$etc/tw.cfg.bak \
	$etc/tw.pol \
	$etc/tw.pol.bak \
	$etc/site.key \
	$etc/${host}-local.key \
	$report/${host}-*.twr \
	$var/${host}.twd*

    lib=/usr/lib/tripwire
    rm -rf $lib/tripwire-1.2 \
	$lib/ztripwire-1.2 \
	/usr/share/man/man8/tripwire-1.2.8.gz \
	$lib/databases

    if [ -d $etc ]; then
	rmdir --ignore-fail-on-non-empty $etc
    fi
    if [ -d $lib ]; then
	rmdir --ignore-fail-on-non-empty $lib
    fi
    if [ -d $report ]; then
	rmdir --ignore-fail-on-non-empty $report
    fi
    if [ -d $var ]; then
	rmdir --ignore-fail-on-non-empty $var
    fi
    ;;

esac

