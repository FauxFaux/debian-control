#!/bin/sh -e

generate_config () {
	db_get uftp/generate_config || RET=
	[ "$RET" = true ] || return

	db_get uftp/dest_dir
	local dest_dir="$RET"
	db_get uftp/arguments
	local args="$RET"

	cat >/etc/default/uftp <<CONF
#
# This is a POSIX shell fragment sourced by /etc/init.d/uftp
# It is managed by debconf - use 'dpkg-reconfigure uftp'.
#
DAEMON_ARGS="-L /var/log/uftp.log -D ${dest_dir} ${args}"
CONF

	db_set uftp/generate_config false
}

case "$1" in
configure)
	. /usr/share/debconf/confmodule
	db_version 2.0

	generate_config
	;;
esac

# Automatically added by dh_installinit/11.3.5
if [ "$1" = "configure" ] || [ "$1" = "abort-upgrade" ] || [ "$1" = "abort-deconfigure" ] || [ "$1" = "abort-remove" ] ; then
	if [ -x "/etc/init.d/uftp" ]; then
		update-rc.d uftp defaults >/dev/null
		invoke-rc.d uftp start || exit 1
	fi
fi
# End automatically added section


exit 0
