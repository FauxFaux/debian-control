#!/bin/sh

set -e

# remove obsolete diversions
if dpkg-divert --list | \
   grep -q '^diversion of /usr/X11R6/lib/openwin-menu to .* by olvwm$'; then
	dpkg-divert --package olvwm --remove --rename \
		--divert /usr/X11R6/lib/openwin-menu.xview /usr/X11R6/lib/openwin-menu
fi
if dpkg-divert --list | \
   grep -q '^diversion of /usr/share/man/man1/olwm.1x to .* by olvwm$'; then
	dpkg-divert --package olvwm --remove --rename \
		--divert /usr/share/man/man1/olwm.1x.xview /usr/share/man/man1/olwm.1x
fi

# Automatically added by dh_installmenu
inst=/etc/menu-methods/olvwm
if [ -f $inst ]; then
	chmod a+x $inst
	if [ -x "`which update-menus 2>/dev/null`" ]; then
		update-menus
	fi
fi
# End automatically added section


if [ "$1" = configure ]; then
  # Remove old alternative (if it's still there)
  update-alternatives --remove x-window-manager /usr/bin/X11/olvwm > /dev/null 2>&1 || true
  # ...and install new one that now points to the wrapper
  update-alternatives --install /usr/bin/x-window-manager x-window-manager /usr/bin/olvwm-x-window-manager 45 \
     --slave /usr/share/man/man1/x-window-manager.1.gz x-window-manager.1.gz /usr/share/man/man1/olvwm.1.gz
fi
