#!/bin/sh
# postinst script for zeroc-icegrid
set -e

if [ "$1" = "configure" ]; then
    for i in icegrid icegrid/node1 icegrid/registry
    do
        if ! dpkg-statoverride --list /var/lib/ice/$i >/dev/null; then
    	   dpkg-statoverride --update --add ice adm 0770 /var/lib/ice/$i >/dev/null 2>/dev/null || true
        fi
    done
fi

# Automatically added by dh_systemd_enable/11.3.2
if [ "$1" = "configure" ] || [ "$1" = "abort-upgrade" ] || [ "$1" = "abort-deconfigure" ] || [ "$1" = "abort-remove" ] ; then
	if deb-systemd-helper debian-installed 'icegridregistry.service'; then
		# This will only remove masks created by d-s-h on package removal.
		deb-systemd-helper unmask 'icegridregistry.service' >/dev/null || true

		if deb-systemd-helper --quiet was-enabled 'icegridregistry.service'; then
			# Create new symlinks, if any.
			deb-systemd-helper enable 'icegridregistry.service' >/dev/null || true
		fi
	fi

	# Update the statefile to add new symlinks (if any), which need to be cleaned
	# up on purge. Also remove old symlinks.
	deb-systemd-helper update-state 'icegridregistry.service' >/dev/null || true
fi
# End automatically added section
# Automatically added by dh_systemd_enable/11.3.2
if [ "$1" = "configure" ] || [ "$1" = "abort-upgrade" ] || [ "$1" = "abort-deconfigure" ] || [ "$1" = "abort-remove" ] ; then
	if deb-systemd-helper debian-installed 'icegridnode.service'; then
		# This will only remove masks created by d-s-h on package removal.
		deb-systemd-helper unmask 'icegridnode.service' >/dev/null || true

		if deb-systemd-helper --quiet was-enabled 'icegridnode.service'; then
			# Create new symlinks, if any.
			deb-systemd-helper enable 'icegridnode.service' >/dev/null || true
		fi
	fi

	# Update the statefile to add new symlinks (if any), which need to be cleaned
	# up on purge. Also remove old symlinks.
	deb-systemd-helper update-state 'icegridnode.service' >/dev/null || true
fi
# End automatically added section
# Automatically added by dh_systemd_enable/11.3.2
if [ "$1" = "configure" ] || [ "$1" = "abort-upgrade" ] || [ "$1" = "abort-deconfigure" ] || [ "$1" = "abort-remove" ] ; then
	if deb-systemd-helper debian-installed 'icegridregistry.service'; then
		# This will only remove masks created by d-s-h on package removal.
		deb-systemd-helper unmask 'icegridregistry.service' >/dev/null || true

		if deb-systemd-helper --quiet was-enabled 'icegridregistry.service'; then
			# Create new symlinks, if any.
			deb-systemd-helper enable 'icegridregistry.service' >/dev/null || true
		fi
	fi

	# Update the statefile to add new symlinks (if any), which need to be cleaned
	# up on purge. Also remove old symlinks.
	deb-systemd-helper update-state 'icegridregistry.service' >/dev/null || true
fi
# End automatically added section
# Automatically added by dh_systemd_enable/11.3.2
if [ "$1" = "configure" ] || [ "$1" = "abort-upgrade" ] || [ "$1" = "abort-deconfigure" ] || [ "$1" = "abort-remove" ] ; then
	if deb-systemd-helper debian-installed 'icegridnode.service'; then
		# This will only remove masks created by d-s-h on package removal.
		deb-systemd-helper unmask 'icegridnode.service' >/dev/null || true

		if deb-systemd-helper --quiet was-enabled 'icegridnode.service'; then
			# Create new symlinks, if any.
			deb-systemd-helper enable 'icegridnode.service' >/dev/null || true
		fi
	fi

	# Update the statefile to add new symlinks (if any), which need to be cleaned
	# up on purge. Also remove old symlinks.
	deb-systemd-helper update-state 'icegridnode.service' >/dev/null || true
fi
# End automatically added section
# Automatically added by dh_systemd_enable/11.3.2
if [ "$1" = "configure" ] || [ "$1" = "abort-upgrade" ] || [ "$1" = "abort-deconfigure" ] || [ "$1" = "abort-remove" ] ; then
	if deb-systemd-helper debian-installed 'icegridregistry.service'; then
		# This will only remove masks created by d-s-h on package removal.
		deb-systemd-helper unmask 'icegridregistry.service' >/dev/null || true

		if deb-systemd-helper --quiet was-enabled 'icegridregistry.service'; then
			# Create new symlinks, if any.
			deb-systemd-helper enable 'icegridregistry.service' >/dev/null || true
		fi
	fi

	# Update the statefile to add new symlinks (if any), which need to be cleaned
	# up on purge. Also remove old symlinks.
	deb-systemd-helper update-state 'icegridregistry.service' >/dev/null || true
fi
# End automatically added section


exit 0
